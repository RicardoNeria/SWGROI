<!-- login.html con estilos separados y adaptado -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Iniciar Sesión - SWGROI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles/login_estilo.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body class="body-login">
    <div class="contenedor-login">
        <div class="login-card">
            <img src="/imagenes/CENTRALDEALARMAS.jpg" alt="Logo Central de Alarmas" class="logo-login">
            <h2>Inicio de Sesión</h2>

            <form id="formLogin" class="form-login">
                <label for="usuario">Usuario:</label>
                <input type="text" id="usuario" required>

                <label for="contrasena">Contraseña:</label>
                <input type="password" id="contrasena" required>

                <div class="captcha-container">
                    <span id="captchaPregunta"></span>
                    <img src="/imagenes/RECAPTCHA.png" alt="Captcha Icono">
                </div>
                <input type="text" id="respuestaCaptcha" placeholder="Tu respuesta" required>

                <button type="submit">Iniciar Sesión</button>
            </form>

            <a href="/recuperar.html" class="link-recuperar">¿Olvidaste tu contraseña?</a>
            <div id="mensajeLogin"></div>
        </div>
    </div>

    <script>
        let captchaResultado = 0;

        function generarCaptcha() {
            const a = Math.floor(Math.random() * 5) + 1;
            const b = Math.floor(Math.random() * 5) + 1;
            captchaResultado = a + b;
            document.getElementById("captchaPregunta").innerText = `¿Cuánto es ${a} + ${b}?`;
        }

        document.addEventListener("DOMContentLoaded", () => {
            generarCaptcha();

            const form = document.getElementById("formLogin");
            form.addEventListener("submit", async function (e) {
                e.preventDefault();

                const respuesta = parseInt(document.getElementById("respuestaCaptcha").value);
                const mensaje = document.getElementById("mensajeLogin");

                const usuario = document.getElementById("usuario").value;
                const contrasena = document.getElementById("contrasena").value;

                const respuestaServidor = await fetch("/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ Usuario: usuario, Contrasena: contrasena })
                });

                const resultado = await respuestaServidor.json();

                if (!resultado.exito) {
                    mensaje.textContent = "Usuario o contraseña incorrectos.";
                    mensaje.style.color = "red";
                    return;
                }

                if (respuesta !== captchaResultado) {
                    mensaje.textContent = "Captcha incorrecto. Por favor, coloca el resultado correcto.";
                    mensaje.style.color = "red";
                    return;
                }

                mensaje.textContent = "Acceso correcto, ingresando al sistema...";
                mensaje.style.color = "green";
                setTimeout(() => {
                    window.location.href = "/menu.html";
                }, 1000);
            });
        });
    </script>
</body>
</html>